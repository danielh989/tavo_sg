function formatoPagos(){$("#efectivo, #debito").priceFormat({prefix:"Bs.F ",centsSeparator:",",thousandsSeparator:"."}),$("input[type=radio]").on("click",function(){var a=$(this).attr("value"),b=$(this).data("total"),c=$("#efectivo"),d=$("#debito"),e=$(".modal-footer button[type=submit]");switch(a){case"efectivo":c.val(b+""),d.val("0"),c.trigger("focus"),d.trigger("focus"),e.trigger("focus");break;case"debito":d.val(b+""),c.val("0"),d.trigger("focus"),c.trigger("focus"),e.trigger("focus")}})}function mesasDisponibles(){var a={id_mesa:"",productos:[]},b={};$("#myModal").on("hidden.bs.modal",function(){a={id_mesa:"",productos:[]}}),$(".table-add").on("click",function(){var a=($(this),"main/getMesas"),b="get",c={};$.ajax({url:a,type:b,data:c,success:function(a){var b=$("#select-table").html();$(".modal-body").html(""),$.each(a,function(c,d){$(".modal-body").append(Mustache.render(b,a[c]))}),$(".modal-footer").html("")}})}),$(".modal-body").on("click",".mesa-libre",function(){var c=$(this),d="main/getCategorias",e="post",f={};a.id_mesa=c.data("id"),$.ajax({url:d,type:e,data:f,success:function(a){b=a;var c=$("#categorias-template").html(),d=$("#btn-completar").html();$(".modal-body").html(""),$.each(a,function(b,d){$(".modal-body").append(Mustache.render(c,a[b]))}),$(".modal-footer").html(""),$(".modal-footer").append(Mustache.render(d))}})}),$(".modal-body").on("click",".categoria",function(){var a=($(this),"main/getProductosXCategoria"),b="post",c={};c.id_cat=$(this).data("id"),$.ajax({url:a,type:b,data:c,success:function(a){var b=$("#productos-template").html(),c=$("#back-button").html();$(".modal-body").html(""),$(".modal-body").append(c),$.each(a,function(c,d){$(".modal-body").append(Mustache.render(b,a[c]))})}})}),$(".modal-body").on("click",".btn-agregar",function(){var b=$(this),c=0,d=b.closest(".number-wrapper").find(".cantidad"),e=parseInt(d.text());d.html(""),""==a.productos?(a.productos.push({id:b.data("id"),cantidad:"1"}),d.append("1")):($.each(a.productos,function(f,g){a.productos[f].id===b.data("id")&&(a.productos[f].cantidad=parseInt(a.productos[f].cantidad)+1,a.productos[f].id=b.data("id"),d.append(e+1),c=1)}),0==c&&(a.productos.push({id:b.data("id"),cantidad:"1"}),d.append("1")))}),$(".modal-body").on("click",".btn-atras",function(){var c=$("#categorias-template").html(),d=$.merge(b,a);$(".modal-body").html(""),$.each(b,function(a,b){$(".modal-body").append(Mustache.render(c,d[a]))})}),$(".modal-footer").on("click",".btn-completar",function(){var b="post",c="main/crear_pedido",d=a;$.ajax({url:c,type:b,data:d,success:function(a){window.location="http://localhost/tavo_sg/"}})})}function gestionarPedidos(){$(".btn-eliminar").on("click",function(){var a="post",b="/tavo_sg/main/eliminar_producto_pedido",c={};c.id_pedido=$(this).data("pedido"),c.id_producto=$(this).data("producto"),console.log(c),$.ajax({type:a,url:b,data:c,success:function(a){location.reload()}})}),$(".btn-eliminar-devuelto").on("click",function(){var a="post",b="/tavo_sg/main/eliminar_producto_devuelto",c={};c.id_pedido=$(this).data("pedido"),c.id_producto=$(this).data("producto"),console.log(c),$.ajax({type:a,url:b,data:c,success:function(a){location.reload()}})}),$(".btn-devolver").on("click",function(){var a="post",b="/tavo_sg/main/devolver_producto_pedido",c={};c.id_pedido=$(this).data("pedido"),c.id_producto=$(this).data("producto"),$.ajax({type:a,url:b,data:c,success:function(a){location.reload()}})})}function gestionarProductos(){$(".btn-agregar").on("click",function(){getCategorias("#id_cat",0),$("input").val(""),$("textarea").val("")}),$(".btn-guardar").on("click",function(){var a=$("form#producto"),b=a.attr("method"),c=a.attr("action"),d=a.serializeArray();d.push({name:"id_cat",value:$("#id_cat").prop("selectedIndex")}),$.ajax({type:b,url:c,data:d,success:function(a){console.log(a)}})}),$(".table tbody .btn-editar").on("click",function(){var a=$(this).closest("tr"),b=a.data("id-producto"),c=a.find(".categoria").text();$("input[name=id]").val(b),$("input[name=nombre]").val(a.find(".nombre").text()),$("input[name=precio]").val(a.find(".precio").text()),$("textarea[name=descripcion]").val(a.find(".descripcion").text()),getCategorias("#id_cat",1,c)}),$(".table tbody .btn-eliminar").on("click",function(){var a=$(this).closest("tr"),b=a.data("id-producto");$("#eliminarProducto a").attr("href","eliminar/"+b)})}function getCategorias(a,b,c){var d="post",e="/tavo_sg/main/getCategorias",f={};$.ajax({type:d,url:e,data:f,success:function(d){sel=$(a),sel.empty(),sel.append('<option value="0">Seleccionar...</option>'),$.each(d,function(a,b){sel.append('<option value"'+d[a].id+'">'+d[a].nombre+"</option>")}),1==b&&sel.val(c)}})}$(function(){mesasDisponibles(),gestionarProductos(),gestionarPedidos(),formatoPagos()});